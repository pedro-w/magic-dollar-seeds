var t=Object.defineProperty,e=(e,s,i)=>((e,s,i)=>s in e?t(e,s,{enumerable:!0,configurable:!0,writable:!0,value:i}):e[s]=i)(e,"symbol"!=typeof s?s+"":s,i);import{p as s}from"./phaser-CrGWs1g-.js";!function(){const t=document.createElement("link").relList;if(!(t&&t.supports&&t.supports("modulepreload"))){for(const t of document.querySelectorAll('link[rel="modulepreload"]'))e(t);new MutationObserver((t=>{for(const s of t)if("childList"===s.type)for(const t of s.addedNodes)"LINK"===t.tagName&&"modulepreload"===t.rel&&e(t)})).observe(document,{childList:!0,subtree:!0})}function e(t){if(t.ep)return;t.ep=!0;const e=function(t){const e={};return t.integrity&&(e.integrity=t.integrity),t.referrerPolicy&&(e.referrerPolicy=t.referrerPolicy),"use-credentials"===t.crossOrigin?e.credentials="include":"anonymous"===t.crossOrigin?e.credentials="omit":e.credentials="same-origin",e}(t);fetch(t.href,e)}}();class i extends s.Scene{constructor(){super("Boot")}preload(){this.load.image("background","assets/bg.png")}create(){this.scene.start("Preloader")}}function l(t,e,s){let i,l,o;return"number"!=typeof t?(i=t.x??0,l=t.y??0,o=t.z??0):(i=t,l=e??0,o=s??0),{x:102*i,y:87*l-85*o}}class o{constructor(t,s,i){e(this,"block"),e(this,"dollar"),e(this,"tileX"),e(this,"tileY"),e(this,"scene"),e(this,"name","ANON"),e(this,"_hole",!1),e(this,"_seed",!1),e(this,"_hasDollar",!1),this.scene=t,this.tileX=s,this.tileY=i;const{x:o,y:r}=l(s,i);this.block=t.add.image(o,r,"block"),this.dollar=t.add.image(o,r-40,"dollar"),this.dollar.alpha=0,this.dollar.active=!1}set hasSeed(t){this.setHasSeed(t)}setHasSeed(t){return t!=this._seed&&(this.block.setTexture(t?"seed-block":"block"),this._seed=t),this}get hasSeed(){return this._seed}set hasDollar(t){this.setHasDollar(t)}setHasDollar(t){if(t!=this._hasDollar){let e;t?(this.dollar.active=!0,this.dollar.alpha=0,e={targets:this.dollar,props:{alpha:1},duration:1e3}):(this.dollar.alpha=1,e={targets:this.dollar,props:{alpha:0},duration:1e3,onComplete:()=>{this.dollar.active=!1}}),this.scene.add.tween(e),this._hasDollar=t}return this}get hasDollar(){return this._hasDollar}set hole(t){this.setHole(t)}setHole(t){if(t!=this._hole){let e;if(t){const t=l(this.tileX,this.tileY,-3);e={targets:this.block,props:{y:t.y,alpha:0}}}else{const t=l(this.tileX,this.tileY,0);e={targets:this.block,props:{y:t.y,alpha:1}}}this.scene.add.tween(e),this._hole=t}return this}get hole(){return this._hole}}class r{constructor(t,s,i){e(this,"image"),e(this,"_tileX"),e(this,"_tileY"),e(this,"scene"),this._tileX=s,this._tileY=i,this.scene=t;const{x:o,y:r}=l(s,i);this.image=t.add.image(o,r,"player").setDepth(.5),this.image.setOrigin(.5,.75)}set tileX(t){this._tileX=t;const{x:e,y:s}=l(this._tileX,this._tileY);this.image.setPosition(e,s)}get tileX(){return this._tileX}set tileY(t){this._tileY=t;const{x:e,y:s}=l(this._tileX,this._tileY);this.image.setPosition(e,s)}get tileY(){return this._tileY}}const a=40;class n extends s.Scene{constructor(){super("Game"),e(this,"camera"),e(this,"background"),e(this,"tiles",[]),e(this,"player"),e(this,"score"),e(this,"spend"),e(this,"stuck"),e(this,"_dollars",0)}create(){this.camera=this.cameras.main,this.camera.setBackgroundColor(1052688),this.background=this.add.image(512,384,"background").setDepth(-1).setScrollFactor(0),this.background.setAlpha(.5),this.score=this.add.text(15,15,"Score",{fontFamily:"sans-serif",fontSize:48,strokeThickness:4,stroke:"#000",color:"#fff"}).setScrollFactor(0).setDepth(1),this.spend=this.add.image(920,50,"spend").setDepth(1).setScrollFactor(0).setVisible(!1).setInteractive(),this.spend.on("pointerdown",(()=>{this.onSpend()})),this.stuck=this.add.image(500,100,"stuck").setDepth(1).setScrollFactor(0).setVisible(!1).setInteractive();for(let t=0;t<15;++t)for(let e=0;e<30;++e){const s=`TILE-${e+30*t}`,i=new o(this,e,t);this.tiles.push(i),i.name=s}this.dollars=0,this.player=new r(this,15,7),this.camera.startFollow(this.player.image),this.input.on("pointerdown",(()=>{this.onClick()}))}onSpend(){if(this.dollars>=a){this.dollars-=a,this.dollarSurround();const t=this.player.tileX,e=this.player.tileY,s=this.getTile(t,e);null==s||s.setHasSeed(!1)}}onClick(){const t=this.input.activePointer,{x:e,y:s}=function(t,e){let s,i;return"number"!=typeof t?(s=t.x,i=t.y):(s=t,i=e??0),{x:s/102,y:i/87}}(t.worldX,t.worldY);if(null!=e&&null!=s){const t=Math.round(e),i=Math.round(s);if(function(t,e,s,i){return!(s<0||s>=30||i<0||i>=15||(t===s?i!==e+1&&i!==e-1:e!==i||s!==t+1&&s!==t-1))}(this.player.tileX,this.player.tileY,t,i)){const e=this.getTile(t,i);if(!(null==e?void 0:e.hole)){this.add.tween({targets:this.player,props:{tileX:t,tileY:i},duration:500,onComplete:()=>this.onMoveComplete()});const e=this.getTile(this.player.tileX,this.player.tileY);null==e||e.setHasSeed(!0)}}}}isStuck(){return this.getNeighbours().every((t=>null==t||t.hole))}dollarSurround(){const t=this.getNeighbours();for(const e of t)null==e||e.setHole(!1).setHasSeed(!1).setHasDollar(!0)}getNeighbours(){const t=this.player.tileX,e=this.player.tileY,s=this.getTile(t-1,e),i=this.getTile(t+1,e),l=this.getTile(t,e-1);return[s,i,this.getTile(t,e+1),l]}onMoveComplete(){const t=this.player.tileX,e=this.player.tileY,s=this.getTile(t,e);if(null!=s){const t=this.getNeighbours();s.hasDollar?(s.hasDollar=!1,this.dollars+=10):s.hasSeed&&(s.hasSeed=!1,this.dollarSurround());for(let e=0;e<2;++e){const e=Phaser.Utils.Array.GetRandom(t);null==e||e.setHole(!0).setHasDollar(!1).setHasSeed(!1)}this.isStuck()&&this.dollars<a&&(this.stuck.setVisible(!0),this.add.tween({targets:this.stuck,props:{alpha:[0,1]}}),this.stuck.once("pointerdown",(()=>this.scene.start("MainMenu"))))}}getTile(t,e){if(null!=t&&null!=e){const s=Math.round(t),i=Math.round(e);if(s>=0&&s<30&&i>=0&&i<15)return this.tiles[s+30*i]}}set dollars(t){this.tweens.addCounter({from:this._dollars,to:t,onUpdate:t=>{const e=Math.round(t.getValue());this.score.setText(`$${e}`)}}),this._dollars>=a&&t<a&&this.add.tween({targets:this.spend,props:{alpha:0},onComplete:()=>{this.spend.setVisible(!1)}}),this._dollars<a&&t>=a&&(this.spend.setVisible(!0),this.add.tween({targets:this.spend,props:{alpha:1}})),this._dollars=t}get dollars(){return this._dollars}}class h extends s.Scene{constructor(){super("GameOver"),e(this,"camera"),e(this,"background"),e(this,"gameover_text")}create(){this.camera=this.cameras.main,this.camera.setBackgroundColor(16711680),this.background=this.add.image(512,384,"background"),this.background.setAlpha(.5),this.gameover_text=this.add.text(512,384,"Game Over",{fontFamily:"Arial Black",fontSize:64,color:"#ffffff",stroke:"#000000",strokeThickness:8,align:"center"}),this.gameover_text.setOrigin(.5),this.input.once("pointerdown",(()=>{this.scene.start("MainMenu")}))}}class c extends s.Scene{constructor(){super("MainMenu"),e(this,"background"),e(this,"logo"),e(this,"title")}create(){this.background=this.add.image(512,384,"background"),this.logo=this.add.image(512,300,"logo"),this.title=this.add.text(512,512,"Click to Play",{fontFamily:"sans-serif",fontSize:38,color:"#ffffff",stroke:"#000000",strokeThickness:8,align:"center"}).setOrigin(.5),this.input.once("pointerdown",(()=>{this.scene.start("Game")}))}}class d extends s.Scene{constructor(){super("Preloader")}init(){this.add.image(512,384,"background"),this.add.rectangle(512,384,468,32).setStrokeStyle(1,16777215);const t=this.add.rectangle(282,384,4,28,16777215);this.load.on("progress",(e=>{t.width=4+460*e}))}preload(){this.load.setPath("assets"),this.load.image("logo","logo.png"),this.load.image("player","Character Pink Girl.png"),this.load.image("block","Brown Block.png"),this.load.image("seed-block","Grass Block.png"),this.load.image("dollar","Gem Blue.png"),this.load.image("spend","Heart.png"),this.load.image("stuck","stuck.png")}create(){this.scene.start("MainMenu")}}const u={type:Phaser.AUTO,width:1024,height:768,parent:"game-container",backgroundColor:"#028af8",scale:{mode:Phaser.Scale.FIT,autoCenter:Phaser.Scale.CENTER_BOTH},scene:[i,d,c,n,h]};new s.Game(u);
